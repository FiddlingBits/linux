/****************************************************************************************************
 * FILE:    goto_and_jmp.c
 * BRIEF:   goto And *jmp Source File
 ****************************************************************************************************/

/****************************************************************************************************
 * Includes
 ****************************************************************************************************/

#include <setjmp.h>
#include <stdbool.h>
#include <stdio.h>
#include <stdlib.h>

/****************************************************************************************************
 * Constants And Variables
 ****************************************************************************************************/

static jmp_buf env;

/****************************************************************************************************
 * Function Prototypes
 ****************************************************************************************************/

static void f1(const bool CallF2);
static void f2(void);

/****************************************************************************************************
 * Function Definitions (Public)
 ****************************************************************************************************/

/****************************************************************************************************
 * FUNCT:   main
 * BRIEF:   Main Entry
 * RETURN:  int: Success Or Failure Status
 * ARG:     argc: Number Of Arguments
 * ARG:     argv: Argument String List
 ****************************************************************************************************/
int main(int argc, char *argv[])
{
    /*** Demonstrate goto ***/
    printf("1... ");
    goto here;
    printf("2... ");
here:
    printf("3...\n");
    
    /*** Demonstrate *jmp ***/
    switch(setjmp(env))
    {
        case 0:
            printf("Calling f1()\n");
            f1(argc > 1);
            break;
        case 1:
            printf("Jumped Back From f1()\n");
            break;
        case 2:
            printf("Jumped Back From f2()\n");
            break;
    }
    
    exit(EXIT_SUCCESS);
}

/****************************************************************************************************
 * Function Definitions (Private)
 ****************************************************************************************************/

/****************************************************************************************************
 * FUNCT:   f1
 * BRIEF:   Function 1
 * RETURN:  void: Returns Nothing
 * ARG:     CallF2: Call F2 Function (true) Or Not (false)
 ****************************************************************************************************/
static void f1(const bool CallF2)
{
    if(CallF2)
        f2();
    longjmp(env, 1);
}

/****************************************************************************************************
 * FUNCT:   f2
 * BRIEF:   Function 2
 * RETURN:  void: Returns Nothing
 * ARG:     void: No Arguments
 ****************************************************************************************************/
static void f2(void)
{
    longjmp(env, 2);
}
